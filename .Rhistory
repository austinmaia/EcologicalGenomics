facet_grid(~site) + #make seperate plots for each site
theme_q2r() +
theme(legend.position="none")+
scale_fill_npg()+
xlab("Site Animal Health") +
ylab("Shannon Diversity") +
ggsave("Shannon_barplot.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
coord_cartesian(ylim=c(2,8.5)) + # adjust y-axis
facet_grid(~site) + #make seperate plots for each site
theme_q2r() +
theme(legend.position="none")+
scale_fill_npg()+
xlab("Site Animal Health") +
ylab("Shannon Diversity") +
ggsave("Shannon_barplot.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
coord_cartesian(ylim=c(2,8.5)) + # adjust y-axis
facet_grid(~site) + #make seperate plots for each site
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("Site Animal Health") +
ylab("Shannon Diversity") +
ggsave("Shannon_barplot.pdf", height=3, width=5, device="pdf")
print(p3)
head(metadata)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth, size=shannon_entropy)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
coord_cartesian(ylim=c(2,8.5)) + # adjust y-axis
facet_grid(~site) + #make seperate plots for each site
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("Site Animal Health") +
ylab("Shannon Diversity") +
ggsave("Shannon_barplot.pdf", height=3, width=5, device="pdf")
print(p3)
p2 <- ggplot(metadata, aes(x=PC1, y=PC2, color=siteanimalhealth, size=shannon_entropy)) +
geom_point(alpha=0.7) + #alpha controls transparency and helps when points are overlapping
theme_q2r()+
scale_color_npg(name="Site Animal Health")+
scale_size_continuous(name="Shannon Diversity") +
ggsave("Shannon_unifrac.pdf", height=3, width=5, device="pdf")
print(p2)
debugSource('~/Documents/GitHub/EcologicalGenomics/qiimeAnalysis.R', echo=TRUE)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
#  coord_cartesian(ylim=c(2,8.5)) + # adjust y-axis
facet_grid(~site) + #make seperate plots for each site
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("Site Animal Health") +
ylab("Shannon Diversity") +
ggsave("Shannon_barplot.pdf", height=3, width=5, device="pdf")
print(p3)
head(metadata)
shannon <- read_qza("diversityMetrics/shannon_vector.qza")
metadata <- read.table("diversityMetrics/pyc_manifest", header=T)
uwunifrac<-read_qza("diversityMetrics/unweighted_unifrac_pcoa_results.qza")
shannon <- shannon$data %>% rownames_to_column("SampleID")
metadata <- merge(x=metadata, y=shannon,by='SampleID') #combine shannon and metadata
vec <- uwunifrac$data$Vectors
pc <- select(vec, SampleID, PC1, PC2)
metadata <- merge(x=metadata, y=pc, by='SampleID')
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
#  coord_cartesian(ylim=c(2,8.5)) + # adjust y-axis
facet_grid(~site) + #make seperate plots for each site
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("Site Animal Health") +
ylab("Shannon Diversity") +
ggsave("Shannon_barplot.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
geom_smooth()+
#  coord_cartesian(ylim=c(2,8.5)) + # adjust y-axis
facet_grid(~site) + #make seperate plots for each site
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("Site Animal Health") +
ylab("Shannon Diversity") +
ggsave("Shannon_barplot.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
geom_smooth()+
#  coord_cartesian(ylim=c(2,8.5)) + # adjust y-axis
facet_grid(~site, nrow=3) + #make seperate plots for each site
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("Site Animal Health") +
ylab("Shannon Diversity") +
ggsave("Shannon_barplot.pdf", height=3, width=5, device="pdf")
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
geom_smooth()+
#  coord_cartesian(ylim=c(2,8.5)) + # adjust y-axis
facet_grid(~site, rows=3) + #make seperate plots for each site
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("Site Animal Health") +
ylab("Shannon Diversity") +
ggsave("Shannon_barplot.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
#  coord_cartesian(ylim=c(2,8.5)) + # adjust y-axis
facet_wrap(~site) + #make seperate plots for each site
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("Site Animal Health") +
ylab("Shannon Diversity") +
ggsave("Shannon_barplot.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
facet_wrap(~site) + #make seperate plots for each site
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("PC1") +
ylab("PC2") +
ggsave("unifrac.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
facet_grid(~site) + #make seperate plots for each site
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("PC1") +
ylab("PC2") +
ggsave("unifrac.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
facet_wrap(~site) + #make seperate plots for each site
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("PC1") +
ylab("PC2") +
ggsave("unifrac.pdf", height=3, width=5, device="pdf")
print(p3)
debugSource('~/Documents/GitHub/EcologicalGenomics/qiimeAnalysis.R', echo=TRUE)
debugSource('~/Documents/GitHub/EcologicalGenomics/qiimeAnalysis.R', echo=TRUE)
shannon <- read_qza("diversityMetrics/shannon_vector.qza")
metadata <- read.table("diversityMetrics/pyc_manifest", header=T)
uwunifrac<-read_qza("diversityMetrics/unweighted_unifrac_pcoa_results.qza")
bcmat <- read_qza("diversityMetrics/bray_curtis_distance_matrix.qza")
shannon <- shannon$data %>% rownames_to_column("SampleID")
metadata <- merge(x=metadata, y=shannon,by='SampleID') #combine shannon and metadata
vec <- uwunifrac$data$Vectors
pc <- select(vec, SampleID, PC1, PC2)
metadata <- merge(x=metadata, y=pc, by='SampleID')
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
facet_wrap(~site) + #make seperate plots for each site
theme(aspect.ratio = 1) +
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("PC1") +
ylab("PC2") +
ggsave("unifrac.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
facet_wrap(~site) + #make seperate plots for each site
#  theme(aspect.ratio = 1) +
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("PC1") +
ylab("PC2") +
ggsave("unifrac.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
facet_wrap(~site) + #make seperate plots for each site
theme(aspect.ratio = 1) +
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("PC1") +
ylab("PC2") +
ggsave("unifrac.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
facet_wrap(~site) + #make seperate plots for each site
coord_fixed(1) +
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("PC1") +
ylab("PC2") +
ggsave("unifrac.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
facet_wrap(~sitestatus) + #make seperate plots for each site
coord_fixed(1) +
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("PC1") +
ylab("PC2") +
ggsave("unifrac.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
facet_wrap(~site) + #make seperate plots for each site
coord_fixed(1) +
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("PC1") +
ylab("PC2") +
ggsave("unifrac.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
facet_wrap_grid(~site) + #make seperate plots for each site
coord_fixed(1) +
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("PC1") +
ylab("PC2") +
ggsave("unifrac.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
facet_wrap(~site) + #make seperate plots for each site
coord_fixed(1) +
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("PC1") +
ylab("PC2") +
ggsave("unifrac.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
facet_wrap(~site, scales="free") + #make seperate plots for each site
coord_fixed(1) +
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("PC1") +
ylab("PC2") +
ggsave("unifrac.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
facet_wrap(~site, scales="free") + #make seperate plots for each site
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("PC1") +
ylab("PC2") +
ggsave("unifrac.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
facet_wrap(~site) + #make seperate plots for each site
coord_fixed(1) +
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("PC1") +
ylab("PC2") +
ggsave("unifrac.pdf", height=3, width=5, device="pdf")
print(p3)
shannon <- read_qza("diversityMetrics/shannon_vector.qza")
library(lemon)
install.packages('lemon')
library(lemon)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
facet_rep_wrap(~site) + #make seperate plots for each site
coord_fixed(1) +
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("PC1") +
ylab("PC2") +
ggsave("unifrac.pdf", height=3, width=5, device="pdf")
print(p3)
labs(color = 'Site Animal Health')
print(p3)
debugSource('~/Documents/GitHub/EcologicalGenomics/qiimeAnalysis.R', echo=TRUE)
shannon <- read_qza("diversityMetrics/shannon_vector.qza")
metadata <- read.table("diversityMetrics/pyc_manifest", header=T)
uwunifrac<-read_qza("diversityMetrics/unweighted_unifrac_pcoa_results.qza")
bcmat <- read_qza("diversityMetrics/bray_curtis_distance_matrix.qza")
shannon <- shannon$data %>% rownames_to_column("SampleID")
metadata <- merge(x=metadata, y=shannon,by='SampleID') #combine shannon and metadata
vec <- uwunifrac$data$Vectors
pc <- select(vec, SampleID, PC1, PC2)
metadata <- merge(x=metadata, y=pc, by='SampleID')
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
facet_rep_wrap(~site) + #make seperate plots for each site
coord_fixed(1) +
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("PC1") +
ylab("PC2") +
labs(color = 'Site Animal Health')+
ggsave("unifrac.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
facet_rep_wrap(~site) + #make seperate plots for each site
coord_fixed(1) +
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("PC1") +
ylab("PC2") +
labs(colour = 'Site Animal Health')+
ggsave("unifrac.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(shape=21, alpha=0.7) +
facet_rep_wrap(~site) + #make seperate plots for each site
coord_fixed(1) +
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("PC1") +
ylab("PC2") +
labs(colour = 'Site Animal Health')+
ggsave("unifrac.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(shape=21, alpha=0.7, color="black") +
facet_rep_wrap(~site) + #make seperate plots for each site
coord_fixed(1) +
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("PC1") +
ylab("PC2") +
labs(colour = 'Site Animal Health')+
ggsave("unifrac.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(shape=21, alpha=0.7, color="black", fill=siteanimalhealth) +
facet_rep_wrap(~site) + #make seperate plots for each site
coord_fixed(1) +
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("PC1") +
ylab("PC2") +
labs(colour = 'Site Animal Health')+
ggsave("unifrac.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
facet_rep_wrap(~site) + #make seperate plots for each site
coord_fixed(1) +
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("PC1") +
ylab("PC2") +
labs(colour = 'Site Animal Health')+
ggsave("unifrac.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
facet_rep_wrap(~site) + #make seperate plots for each site
coord_fixed(1) +
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("PC1") +
ylab("PC2") +
theme(legend.position="bottom")
ggsave("unifrac.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
facet_rep_wrap(~site) + #make seperate plots for each site
coord_fixed(1) +
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("PC1") +
ylab("PC2") +
scale_colour_manual(name="Site Animal Health:"):
theme(legend.position="bottom") +
ggsave("unifrac.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
facet_rep_wrap(~site) + #make seperate plots for each site
coord_fixed(1) +
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("PC1") +
ylab("PC2") +
scale_colour_manual(name="Site Animal Health:"):
theme(legend.position="right") +
ggsave("unifrac.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
facet_rep_wrap(~site) + #make seperate plots for each site
coord_fixed(1) +
theme_q2r() +
theme(legend.position="none")+
scale_color_npg()+
xlab("PC1") +
ylab("PC2") +
scale_colour_manual(name="Site Animal Health:")+
theme(legend.position="right") +
ggsave("unifrac.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
facet_rep_wrap(~site) + #make seperate plots for each site
coord_fixed(1) +
theme_q2r() +
theme(legend.position="none")+
scale_color_npg(name="Site Animal Health:")+
xlab("PC1") +
ylab("PC2") +
theme(legend.position="right") +
ggsave("unifrac.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
facet_rep_wrap(~site) + #make seperate plots for each site
coord_fixed(1) +
theme_q2r() +
theme(legend.position="none")+
scale_color_npg(name="Site Animal Health:")+
xlab("PC1") +
ylab("PC2") +
#  theme(legend.position="right") +
ggsave("unifrac.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
facet_rep_wrap(~site) + #make seperate plots for each site
coord_fixed(1) +
theme_q2r() +
theme(legend.position="none")+
scale_color_npg(name="Site Animal Health:")+
xlab("PC1") +
ylab("PC2") +
theme(legend.position="right") +
ggsave("unifrac.pdf", height=3, width=5, device="pdf")
print(p3)
p3 <- ggplot(metadata,aes(x=PC1,y=PC2, color=siteanimalhealth)) + #plotting site/animal health vs shannon
geom_point(alpha=0.7) +
facet_rep_wrap(~site) + #make seperate plots for each site
coord_fixed(1) +
theme_q2r() +
theme(legend.position="none")+
scale_color_npg(name="Site Animal Health:")+
xlab("PC1") +
ylab("PC2") +
theme(legend.position="right") +
ggsave("unifracSite.pdf", height=3, width=5, device="pdf")
print(p3)
p1 <- ggplot(metadata,aes(x=siteanimalhealth,y=shannon_entropy,fill=siteanimalhealth)) + #plotting site/animal health vs shannon
stat_summary(geom="bar", fun.data=mean_se) + #bar outline
geom_jitter(shape=21, width=0.1, height=0)+ #arrange points
coord_cartesian(ylim=c(2,8.5)) + # adjust y-axis
facet_grid(~site) + #make seperate plots for each site
theme_q2r() +
theme(legend.position="none")+
scale_fill_npg()+
xlab("Site Animal Health") +
ylab("Shannon Diversity") +
ggsave("Shannon_barplot.pdf", height=3, width=5, device="pdf")
print(p1)
p2 <- ggplot(metadata, aes(x=PC1, y=PC2, color=siteanimalhealth, size=shannon_entropy)) +
geom_point(alpha=0.7, fill=siteanimalhealth) + #alpha controls transparency and helps when points are overlapping
theme_q2r()+
scale_color_npg(name="Site Animal Health")+
scale_size_continuous(name="Shannon Diversity") +
ggsave("Shannon_unifrac.pdf", height=3, width=5, device="pdf")
print(p2)
p2 <- ggplot(metadata, aes(x=PC1, y=PC2, color=siteanimalhealth, size=shannon_entropy)) +
geom_point(alpha=0.7) + #alpha controls transparency and helps when points are overlapping
theme_q2r()+
scale_color_npg(name="Site Animal Health")+
scale_size_continuous(name="Shannon Diversity") +
ggsave("Shannon_unifrac.pdf", height=3, width=5, device="pdf")
print(p2)
